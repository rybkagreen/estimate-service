# Криптографические ключи и безопасность

## Описание ключей

### JWT_SECRET

- **Значение**:
  `VcPSJ9QZ02dbUAPtDvpdyKiC8kmUsagzv3qcqr403c2iw/iB6MKwQviZWGw1hiCZDBUF5WEaJndFtQ6wixewTA==`
- **Назначение**: Подпись и верификация JWT токенов
- **Алгоритм**: HS512 (HMAC-SHA512)
- **Длина**: 512 бит (64 байта)

### MASTER_API_KEY

- **Значение**:
  `98590c8659bb80eb27067812b6028034ee188aef021f211a2ef99bfb6b3ecb58`
- **Назначение**: Мастер-ключ для административных API операций
- **Формат**: SHA256 хеш
- **Длина**: 256 бит (32 байта)

### ENCRYPTION_KEY

- **Значение**:
  `KTXeCxSISudZ2/cIZHDWQssMSJ0ziYH/SBfNy9PkTOWZwzACsK7QWNhRc0mqW3zC`
- **Назначение**: Шифрование чувствительных данных в базе данных
- **Алгоритм**: AES-256-GCM
- **Длина**: 256 бит (32 байта)

## Рекомендации по безопасности

### 1. Хранение ключей

#### Development

- Ключи хранятся в `.env` файле
- `.env` файл должен быть в `.gitignore`
- Не коммитьте файлы с реальными ключами

#### Production

- Используйте переменные окружения
- Храните ключи в секретном менеджере (AWS Secrets Manager, HashiCorp Vault,
  etc.)
- Используйте ротацию ключей

### 2. Использование в коде

```typescript
// Правильно
const jwtSecret = process.env.JWT_SECRET;
if (!jwtSecret) {
  throw new Error('JWT_SECRET is not configured');
}

// Неправильно
const jwtSecret =
  'VcPSJ9QZ02dbUAPtDvpdyKiC8kmUsagzv3qcqr403c2iw/iB6MKwQviZWGw1hiCZDBUF5WEaJndFtQ6wixewTA==';
```

### 3. Ротация ключей

#### JWT_SECRET

- Рекомендуемая частота: каждые 3-6 месяцев
- Процесс:
  1. Генерация нового ключа
  2. Параллельная поддержка старого и нового ключа
  3. Постепенный переход на новый ключ
  4. Удаление старого ключа

#### MASTER_API_KEY

- Рекомендуемая частота: при смене персонала или компрометации
- Процесс:
  1. Генерация нового ключа
  2. Обновление во всех сервисах
  3. Отзыв старого ключа

#### ENCRYPTION_KEY

- Рекомендуемая частота: ежегодно
- Процесс:
  1. Генерация нового ключа
  2. Перешифровка данных новым ключом
  3. Проверка целостности
  4. Удаление старого ключа

### 4. Генерация новых ключей

```bash
# JWT_SECRET (Base64 encoded)
openssl rand -base64 64

# MASTER_API_KEY (Hex encoded)
openssl rand -hex 32

# ENCRYPTION_KEY (Base64 encoded)
openssl rand -base64 32
```

### 5. Проверка безопасности

- [ ] Все ключи уникальны
- [ ] Ключи имеют достаточную энтропию
- [ ] Ключи не хранятся в коде
- [ ] Доступ к ключам ограничен
- [ ] Настроена ротация ключей
- [ ] Есть процедура восстановления

### 6. Инциденты безопасности

При компрометации ключей:

1. Немедленно сгенерируйте новые ключи
2. Обновите все сервисы
3. Отзовите все активные сессии
4. Проведите аудит доступа
5. Документируйте инцидент

### 7. Compliance

- Соответствие ГОСТ Р 34.10-2018
- Поддержка FIPS 140-2
- Готовность к требованиям ФСБ

## Контакты

По вопросам безопасности обращайтесь:

- Email: security@yourdomain.com
- Telegram: @security_team
